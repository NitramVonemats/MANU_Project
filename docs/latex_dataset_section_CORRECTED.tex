% ==============================================================================
% DATASET SECTION - CODE-VERIFIED VERSION
% All numbers and descriptions verified against actual implementation
% Generated: 2026-01-19
% ==============================================================================

\section{Datasets}
\label{sec:datasets}

We evaluate our hyperparameter optimization framework on six molecular property
prediction tasks from the Therapeutics Data Commons (TDC)~\cite{huang2021therapeutics},
comprising four ADME regression tasks and two toxicity classification tasks
(Table~\ref{tab:datasets}).

\subsection{ADME Regression Tasks}

\textbf{Caco-2 Permeability (Caco2\_Wang):}
Measures apparent permeability coefficient across Caco-2 monolayers, a widely used
\emph{in vitro} model for human intestinal absorption~\cite{wang2016admet}. High
permeability (log $P_{app} > -5$) indicates good oral bioavailability. Dataset
contains 819 compounds with target values in log(cm/s) units (already log-transformed).

\textbf{Half-Life (Half\_Life\_Obach):}
Predicts human plasma half-life (hours), a critical pharmacokinetic parameter
governing dosing frequency~\cite{obach2008trend}. Longer half-life reduces dosing
frequency but may increase toxicity risk. Dataset contains 601 FDA-approved drugs
with targets ranging from 0.5 to 100+ hours.

\textbf{Hepatocyte Clearance (Clearance\_Hepatocyte\_AZ):}
Measures intrinsic clearance in human hepatocytes, predicting hepatic metabolism
rate~\cite{riley2001pharma}. Low clearance indicates longer \emph{in vivo}
half-life. Dataset contains 1,092 AstraZeneca compounds with targets in
$\mu$L/min/10$^6$ cells.

\textbf{Microsomal Clearance (Clearance\_Microsome\_AZ):}
Predicts intrinsic clearance in human liver microsomes, an \emph{in vitro} assay
for metabolic stability~\cite{obach2006trend}. Complements hepatocyte clearance
with higher throughput but lower physiological relevance. Dataset contains 992
compounds from AstraZeneca screening.

\subsection{Toxicity Classification Tasks}

\textbf{Tox21 Nuclear Receptor Panel:}
The Tox21 dataset contains 12 nuclear receptor (NR) and stress response assays
for environmental toxicity screening~\cite{tox21}. We evaluate the \textbf{NR-AR}
(Nuclear Receptor - Androgen Receptor) assay, which identifies compounds that
disrupt androgen signaling, a key endocrine toxicity mechanism. Binary classification
(active/inactive) on 6,533 compounds after removing entries with invalid SMILES.
The dataset is highly imbalanced with only 3.8\% positive (active) samples (247 out of 6,533).

\textbf{hERG Cardiotoxicity:}
Predicts blockage of the human Ether-Ã -go-go-Related Gene (hERG) potassium channel,
a primary cause of drug-induced cardiac arrhythmias and sudden death~\cite{sanguinetti2006herg}.
Binary classification (blocker/non-blocker) on 590 compounds. The positive class (hERG blockers)
comprises 69.7\% of samples (411 out of 590).

\subsection{Data Preprocessing and Splits}

All datasets were obtained from TDC version 0.4.0 with standardized SMILES strings.
Molecular graphs were constructed using RDKit~\cite{rdkit} with hydrogen atoms
implicit. We used \textbf{scaffold splits}~\cite{wu2018moleculenet} from TDC's
built-in splitting function with fixed random seed (\texttt{seed=42}) for reproducibility.
Scaffold splits partition molecules based on Bemis-Murcko scaffolds, ensuring test
set molecules have different core structures than training set, providing a more
realistic evaluation of generalization to novel chemical space compared to random splits.

The scaffold split from TDC provides train and test sets. We further split the
training set into train (90\% of original train) and validation (10\% of original train)
using random shuffling with the same seed, yielding approximate 80/10/10 proportions.
The same data splits were reused across all model types (GNN, ChemBERTa, Morgan
Fingerprints) to ensure fair comparison.

For regression tasks:
\begin{itemize}[noitemsep,topsep=0pt]
    \item \textbf{Caco2\_Wang:} Target values are already in log(cm/s) units (all negative).
    We apply z-score normalization only: $y' = (y - \mu_{\text{train}}) / \sigma_{\text{train}}$.

    \item \textbf{Other regression tasks:} Target values are positive. We apply log
    transformation followed by z-score normalization:
    $y' = (\log(y) - \mu_{\log}) / \sigma_{\log}$.
\end{itemize}

For classification tasks, target values are kept as binary labels (0/1) without transformation.

All molecular descriptors (ADME features) are z-score normalized using training set
statistics: $x' = (x - \mu_{\text{train}}) / \sigma_{\text{train}}$.

% ============================================================================
% TABLE: Dataset Statistics (CODE-VERIFIED)
% ============================================================================
\begin{table}[t]
\centering
\caption{Dataset statistics for ADMET prediction tasks. All datasets from TDC with
scaffold splits (seed=42). Validation is 10\% of TDC train split. Compounds with
invalid SMILES (failing RDKit parsing) are excluded.}
\label{tab:datasets}
\scriptsize
\begin{tabular}{lcccccc}
\toprule
\textbf{Dataset} & \textbf{Task} & \textbf{N} & \textbf{Train} & \textbf{Val} & \textbf{Test} & \textbf{Target Units} \\
\midrule
\multicolumn{7}{l}{\emph{ADME Regression Tasks}} \\
\midrule
Caco2\_Wang & Regr. & 819 & 574 & 63 & 182 & log(cm/s)$^\dagger$ \\
Half\_Life\_Obach & Regr. & 601 & 420 & 46 & 135 & hours \\
Clearance\_Hepatocyte\_AZ & Regr. & 1,092 & 765 & 84 & 243 & $\mu$L/min/10$^6$ cells \\
Clearance\_Microsome\_AZ & Regr. & 992 & 694 & 77 & 221 & $\mu$L/min/10$^6$ cells \\
\midrule
\multicolumn{7}{l}{\emph{Toxicity Classification Tasks}} \\
\midrule
Tox21 (NR-AR) & Class. & 6,533 & 4,572 & 508 & 1,453 & 3.8\% positive \\
hERG & Class. & 590 & 413 & 45 & 132 & 69.7\% positive \\
\midrule
\textbf{Total} & --- & \textbf{10,627} & 7,438 & 823 & 2,366 & --- \\
\bottomrule
\multicolumn{7}{l}{\scriptsize $^\dagger$ Caco2\_Wang targets are already log-transformed} \\
\end{tabular}
\end{table}

% ============================================================================
% FIGURE SUGGESTIONS (add captions)
% ============================================================================
% Figure 1: Target value distributions (histograms, 6 subplots)
% Figure 2: Molecular weight and TPSA distributions across datasets
% Figure 3: Scaffold diversity analysis (Tanimoto similarity, train vs test)
