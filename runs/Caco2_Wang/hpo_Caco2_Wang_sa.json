{
  "algo": "sa",
  "dataset": "Caco2_Wang",
  "seed": 42,
  "search": {
    "trials": 50,
    "best_val_rmse": 0.0037118445616215467,
    "best_params": {
      "hidden_dim": 384,
      "num_layers": 4,
      "head_dims": [
        512,
        192,
        48
      ],
      "lr": 0.0030702467073594132,
      "weight_decay": 0.0026897777309132674,
      "batch_train": 32,
      "batch_eval": 64,
      "val_fraction": 0.1
    }
  },
  "final_training": {
    "epochs": 50,
    "patience": 12,
    "train_time": 68.89900279045105,
    "val_metrics": {
      "rmse": 0.0037118445616215467,
      "mae": 0.0027618156746029854,
      "r2": 0.5513194799423218
    },
    "test_metrics": {
      "rmse": 0.0028757527470588684,
      "mae": 0.002273672493174672,
      "r2": 0.41467440128326416
    },
    "history": [
      {
        "epoch": 1.0,
        "train_loss": 1.0762061377366383,
        "val_rmse": 0.0052940696477890015,
        "val_mae": 0.004010852426290512,
        "val_r2": 0.0872812271118164
      },
      {
        "epoch": 2.0,
        "train_loss": 0.9862667553954654,
        "val_rmse": 0.005342917982488871,
        "val_mae": 0.004242329858243465,
        "val_r2": 0.07036012411117554
      },
      {
        "epoch": 3.0,
        "train_loss": 0.830532431602478,
        "val_rmse": 0.005398038309067488,
        "val_mae": 0.004363470245152712,
        "val_r2": 0.05107998847961426
      },
      {
        "epoch": 4.0,
        "train_loss": 0.8109835717413161,
        "val_rmse": 0.006222193595021963,
        "val_mae": 0.005376305431127548,
        "val_r2": -0.26079583168029785
      },
      {
        "epoch": 5.0,
        "train_loss": 0.817659361494912,
        "val_rmse": 0.005523160565644503,
        "val_mae": 0.004508188460022211,
        "val_r2": 0.006579697132110596
      },
      {
        "epoch": 6.0,
        "train_loss": 0.6697918342219459,
        "val_rmse": 0.006957475561648607,
        "val_mae": 0.0059855724684894085,
        "val_r2": -0.5763806104660034
      },
      {
        "epoch": 7.0,
        "train_loss": 0.7061986956331465,
        "val_rmse": 0.005574689246714115,
        "val_mae": 0.004602242261171341,
        "val_r2": -0.012043237686157227
      },
      {
        "epoch": 8.0,
        "train_loss": 0.6322932342688242,
        "val_rmse": 0.005258179269731045,
        "val_mae": 0.004399050958454609,
        "val_r2": 0.09961444139480591
      },
      {
        "epoch": 9.0,
        "train_loss": 0.6627911643849479,
        "val_rmse": 0.005231871735304594,
        "val_mae": 0.004276311490684748,
        "val_r2": 0.10860145092010498
      },
      {
        "epoch": 10.0,
        "train_loss": 0.6483421242899365,
        "val_rmse": 0.0058536226861178875,
        "val_mae": 0.005056142341345549,
        "val_r2": -0.11585342884063721
      },
      {
        "epoch": 11.0,
        "train_loss": 0.6887081629700131,
        "val_rmse": 0.004775158129632473,
        "val_mae": 0.003835752373561263,
        "val_r2": 0.2574371099472046
      },
      {
        "epoch": 12.0,
        "train_loss": 0.6279587894678116,
        "val_rmse": 0.005607422441244125,
        "val_mae": 0.004728942643851042,
        "val_r2": -0.023962974548339844
      },
      {
        "epoch": 13.0,
        "train_loss": 0.5833848350577884,
        "val_rmse": 0.0042687589302659035,
        "val_mae": 0.003182656830176711,
        "val_r2": 0.4065816402435303
      },
      {
        "epoch": 14.0,
        "train_loss": 0.627431516846021,
        "val_rmse": 0.004312497563660145,
        "val_mae": 0.003252253867685795,
        "val_r2": 0.39435869455337524
      },
      {
        "epoch": 15.0,
        "train_loss": 0.6101495855384402,
        "val_rmse": 0.004910504445433617,
        "val_mae": 0.003485482418909669,
        "val_r2": 0.21474647521972656
      },
      {
        "epoch": 16.0,
        "train_loss": 0.6456665098667145,
        "val_rmse": 0.004752613138407469,
        "val_mae": 0.0038942222017794847,
        "val_r2": 0.2644323706626892
      },
      {
        "epoch": 17.0,
        "train_loss": 0.5309072434902191,
        "val_rmse": 0.004255813080817461,
        "val_mae": 0.0032450419384986162,
        "val_r2": 0.4101754426956177
      },
      {
        "epoch": 18.0,
        "train_loss": 0.5524381481938891,
        "val_rmse": 0.005283690989017487,
        "val_mae": 0.004499234724789858,
        "val_r2": 0.09085637331008911
      },
      {
        "epoch": 19.0,
        "train_loss": 0.5624844945139356,
        "val_rmse": 0.004373563919216394,
        "val_mae": 0.003526940243318677,
        "val_r2": 0.37708520889282227
      },
      {
        "epoch": 20.0,
        "train_loss": 0.5774401757452223,
        "val_rmse": 0.004178336355835199,
        "val_mae": 0.003111000871285796,
        "val_r2": 0.43145543336868286
      },
      {
        "epoch": 21.0,
        "train_loss": 0.5396447877089182,
        "val_rmse": 0.004184925463050604,
        "val_mae": 0.0031425105407834053,
        "val_r2": 0.42966097593307495
      },
      {
        "epoch": 22.0,
        "train_loss": 0.527426448961099,
        "val_rmse": 0.004407232161611319,
        "val_mae": 0.0034667025320231915,
        "val_r2": 0.36745762825012207
      },
      {
        "epoch": 23.0,
        "train_loss": 0.547422844502661,
        "val_rmse": 0.005427620839327574,
        "val_mae": 0.0038715647533535957,
        "val_r2": 0.04065072536468506
      },
      {
        "epoch": 24.0,
        "train_loss": 0.5547128286626604,
        "val_rmse": 0.004664131905883551,
        "val_mae": 0.003505953121930361,
        "val_r2": 0.29156607389450073
      },
      {
        "epoch": 25.0,
        "train_loss": 0.5556890351904763,
        "val_rmse": 0.0050939409993588924,
        "val_mae": 0.004211684223264456,
        "val_r2": 0.15498292446136475
      },
      {
        "epoch": 26.0,
        "train_loss": 0.5029134386115603,
        "val_rmse": 0.004308321978896856,
        "val_mae": 0.003173902863636613,
        "val_r2": 0.3955310583114624
      },
      {
        "epoch": 27.0,
        "train_loss": 0.5339525689681371,
        "val_rmse": 0.004582015797495842,
        "val_mae": 0.003709926502779126,
        "val_r2": 0.3162916302680969
      },
      {
        "epoch": 28.0,
        "train_loss": 0.5115838232967589,
        "val_rmse": 0.004225639626383781,
        "val_mae": 0.002977027092128992,
        "val_r2": 0.41850942373275757
      },
      {
        "epoch": 29.0,
        "train_loss": 0.46124742759598625,
        "val_rmse": 0.003947273828089237,
        "val_mae": 0.0028864683117717505,
        "val_r2": 0.49259793758392334
      },
      {
        "epoch": 30.0,
        "train_loss": 0.47971071634027695,
        "val_rmse": 0.0038919253274798393,
        "val_mae": 0.0027834915090352297,
        "val_r2": 0.5067276954650879
      },
      {
        "epoch": 31.0,
        "train_loss": 0.49925121996137833,
        "val_rmse": 0.004061745014041662,
        "val_mae": 0.0028997876215726137,
        "val_r2": 0.46274179220199585
      },
      {
        "epoch": 32.0,
        "train_loss": 0.48511463072564864,
        "val_rmse": 0.004091319162398577,
        "val_mae": 0.0028999699279665947,
        "val_r2": 0.45488959550857544
      },
      {
        "epoch": 33.0,
        "train_loss": 0.5007160007953644,
        "val_rmse": 0.00388327450491488,
        "val_mae": 0.002891095355153084,
        "val_r2": 0.5089181661605835
      },
      {
        "epoch": 34.0,
        "train_loss": 0.44665558718972737,
        "val_rmse": 0.004107230342924595,
        "val_mae": 0.0029565871227532625,
        "val_r2": 0.4506415128707886
      },
      {
        "epoch": 35.0,
        "train_loss": 0.5070665379365286,
        "val_rmse": 0.0045088487677276134,
        "val_mae": 0.003214387921616435,
        "val_r2": 0.3379526138305664
      },
      {
        "epoch": 36.0,
        "train_loss": 0.46755172808965045,
        "val_rmse": 0.004233951680362225,
        "val_mae": 0.0030323960818350315,
        "val_r2": 0.4162195920944214
      },
      {
        "epoch": 37.0,
        "train_loss": 0.5013670929604106,
        "val_rmse": 0.0037118445616215467,
        "val_mae": 0.0027618156746029854,
        "val_r2": 0.5513194799423218
      },
      {
        "epoch": 38.0,
        "train_loss": 0.4531527641746733,
        "val_rmse": 0.004031155724078417,
        "val_mae": 0.002904916647821665,
        "val_r2": 0.4708036780357361
      },
      {
        "epoch": 39.0,
        "train_loss": 0.46291671362188125,
        "val_rmse": 0.0038746902719140053,
        "val_mae": 0.002833490027114749,
        "val_r2": 0.5110868215560913
      },
      {
        "epoch": 40.0,
        "train_loss": 0.4730200295646985,
        "val_rmse": 0.003855121787637472,
        "val_mae": 0.0027433207724243402,
        "val_r2": 0.5160127878189087
      },
      {
        "epoch": 41.0,
        "train_loss": 0.4887277732292811,
        "val_rmse": 0.004486332181841135,
        "val_mae": 0.0032058435026556253,
        "val_r2": 0.34454846382141113
      },
      {
        "epoch": 42.0,
        "train_loss": 0.4829624974065357,
        "val_rmse": 0.003951568156480789,
        "val_mae": 0.002837987383827567,
        "val_r2": 0.491493284702301
      },
      {
        "epoch": 43.0,
        "train_loss": 0.46121931821107864,
        "val_rmse": 0.004584983456879854,
        "val_mae": 0.003189267823472619,
        "val_r2": 0.3154056668281555
      },
      {
        "epoch": 44.0,
        "train_loss": 0.48679472837183213,
        "val_rmse": 0.003935147076845169,
        "val_mae": 0.0028577193152159452,
        "val_r2": 0.4957107901573181
      },
      {
        "epoch": 45.0,
        "train_loss": 0.46494778990745544,
        "val_rmse": 0.004221761133521795,
        "val_mae": 0.002932511502876878,
        "val_r2": 0.4195765256881714
      },
      {
        "epoch": 46.0,
        "train_loss": 0.4993956817520989,
        "val_rmse": 0.004600487183779478,
        "val_mae": 0.0032320821192115545,
        "val_r2": 0.31076812744140625
      },
      {
        "epoch": 47.0,
        "train_loss": 0.4644542849726147,
        "val_rmse": 0.003890465246513486,
        "val_mae": 0.002924424596130848,
        "val_r2": 0.5070977210998535
      },
      {
        "epoch": 48.0,
        "train_loss": 0.4425545020235909,
        "val_rmse": 0.004136251285672188,
        "val_mae": 0.0029027597047388554,
        "val_r2": 0.44285082817077637
      },
      {
        "epoch": 49.0,
        "train_loss": 0.44618147280481124,
        "val_rmse": 0.004478170536458492,
        "val_mae": 0.0032001971267163754,
        "val_r2": 0.3469311594963074
      }
    ],
    "mu": -5.208833694458008,
    "sigma": 0.786635160446167
  }
}