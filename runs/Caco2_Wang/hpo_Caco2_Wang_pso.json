{
  "algo": "pso",
  "dataset": "Caco2_Wang",
  "seed": 42,
  "search": {
    "trials": 50,
    "best_val_rmse": 0.00371950282715261,
    "best_params": {
      "hidden_dim": 256,
      "num_layers": 4,
      "head_dims": [
        384,
        96,
        64
      ],
      "lr": 0.0018337021671045932,
      "weight_decay": 0.0010773354740351783,
      "batch_train": 32,
      "batch_eval": 64,
      "val_fraction": 0.1
    }
  },
  "final_training": {
    "epochs": 50,
    "patience": 12,
    "train_time": 47.19400095939636,
    "val_metrics": {
      "rmse": 0.00371950282715261,
      "mae": 0.0027955793775618076,
      "r2": 0.549466073513031
    },
    "test_metrics": {
      "rmse": 0.0031028753146529198,
      "mae": 0.0023368860129266977,
      "r2": 0.3185672163963318
    },
    "history": [
      {
        "epoch": 1.0,
        "train_loss": 1.128568884399202,
        "val_rmse": 0.005506077781319618,
        "val_mae": 0.00407258840277791,
        "val_r2": 0.01271522045135498
      },
      {
        "epoch": 2.0,
        "train_loss": 1.1163172920544941,
        "val_rmse": 0.005252641160041094,
        "val_mae": 0.004116639029234648,
        "val_r2": 0.10151010751724243
      },
      {
        "epoch": 3.0,
        "train_loss": 1.027225931485494,
        "val_rmse": 0.005522083956748247,
        "val_mae": 0.004536023363471031,
        "val_r2": 0.006966888904571533
      },
      {
        "epoch": 4.0,
        "train_loss": 0.893259197473526,
        "val_rmse": 0.005294728092849255,
        "val_mae": 0.004318234510719776,
        "val_r2": 0.08705407381057739
      },
      {
        "epoch": 5.0,
        "train_loss": 0.8133242792553372,
        "val_rmse": 0.005721425171941519,
        "val_mae": 0.004828169476240873,
        "val_r2": -0.06602203845977783
      },
      {
        "epoch": 6.0,
        "train_loss": 0.8123963425556818,
        "val_rmse": 0.0051534236408770084,
        "val_mae": 0.004195095971226692,
        "val_r2": 0.13513284921646118
      },
      {
        "epoch": 7.0,
        "train_loss": 0.7658509959777197,
        "val_rmse": 0.00501345144584775,
        "val_mae": 0.004106405656784773,
        "val_r2": 0.1814761757850647
      },
      {
        "epoch": 8.0,
        "train_loss": 0.6883666333225038,
        "val_rmse": 0.005719318520277739,
        "val_mae": 0.0047578755766153336,
        "val_r2": -0.06523704528808594
      },
      {
        "epoch": 9.0,
        "train_loss": 0.6420034964879354,
        "val_rmse": 0.0052408683113753796,
        "val_mae": 0.004272830672562122,
        "val_r2": 0.10553324222564697
      },
      {
        "epoch": 10.0,
        "train_loss": 0.6375214242272906,
        "val_rmse": 0.005077270325273275,
        "val_mae": 0.004208012949675322,
        "val_r2": 0.16050469875335693
      },
      {
        "epoch": 11.0,
        "train_loss": 0.64066710571448,
        "val_rmse": 0.0045829894952476025,
        "val_mae": 0.003596802009269595,
        "val_r2": 0.3160009980201721
      },
      {
        "epoch": 12.0,
        "train_loss": 0.6009204122755263,
        "val_rmse": 0.005681518465280533,
        "val_mae": 0.004867293406277895,
        "val_r2": -0.05120289325714111
      },
      {
        "epoch": 13.0,
        "train_loss": 0.5417775395843718,
        "val_rmse": 0.005382122937589884,
        "val_mae": 0.0044182478450238705,
        "val_r2": 0.05666714906692505
      },
      {
        "epoch": 14.0,
        "train_loss": 0.5639527870549096,
        "val_rmse": 0.005020864773541689,
        "val_mae": 0.004047960974276066,
        "val_r2": 0.17905360460281372
      },
      {
        "epoch": 15.0,
        "train_loss": 0.5454611248440213,
        "val_rmse": 0.0050546545535326,
        "val_mae": 0.004301983397454023,
        "val_r2": 0.1679668426513672
      },
      {
        "epoch": 16.0,
        "train_loss": 0.5626564721266428,
        "val_rmse": 0.004365058150142431,
        "val_mae": 0.0033699851483106613,
        "val_r2": 0.3795056939125061
      },
      {
        "epoch": 17.0,
        "train_loss": 0.5387715051571528,
        "val_rmse": 0.004675702657550573,
        "val_mae": 0.0036345652770251036,
        "val_r2": 0.28804677724838257
      },
      {
        "epoch": 18.0,
        "train_loss": 0.5328736321793662,
        "val_rmse": 0.004523091018199921,
        "val_mae": 0.0035595593508332968,
        "val_r2": 0.33376359939575195
      },
      {
        "epoch": 19.0,
        "train_loss": 0.5456478347380956,
        "val_rmse": 0.004861886613070965,
        "val_mae": 0.004146422725170851,
        "val_r2": 0.23021864891052246
      },
      {
        "epoch": 20.0,
        "train_loss": 0.5178569091690911,
        "val_rmse": 0.004192901775240898,
        "val_mae": 0.003088506171479821,
        "val_r2": 0.42748475074768066
      },
      {
        "epoch": 21.0,
        "train_loss": 0.5143986451956961,
        "val_rmse": 0.004394743125885725,
        "val_mae": 0.0034345563035458326,
        "val_r2": 0.3710375428199768
      },
      {
        "epoch": 22.0,
        "train_loss": 0.44982072048717076,
        "val_rmse": 0.004079239442944527,
        "val_mae": 0.002989685395732522,
        "val_r2": 0.45810383558273315
      },
      {
        "epoch": 23.0,
        "train_loss": 0.473238456580374,
        "val_rmse": 0.004377517383545637,
        "val_mae": 0.0035062951501458883,
        "val_r2": 0.3759584426879883
      },
      {
        "epoch": 24.0,
        "train_loss": 0.48659569438960815,
        "val_rmse": 0.004540914203971624,
        "val_mae": 0.0035855036694556475,
        "val_r2": 0.3285026550292969
      },
      {
        "epoch": 25.0,
        "train_loss": 0.4540785600741704,
        "val_rmse": 0.004005145747214556,
        "val_mae": 0.0030422320123761892,
        "val_r2": 0.47761058807373047
      },
      {
        "epoch": 26.0,
        "train_loss": 0.5314206861787372,
        "val_rmse": 0.004275176208466291,
        "val_mae": 0.0032902590464800596,
        "val_r2": 0.40479612350463867
      },
      {
        "epoch": 27.0,
        "train_loss": 0.4716413915157318,
        "val_rmse": 0.004041779320687056,
        "val_mae": 0.0030182369519025087,
        "val_r2": 0.4680106043815613
      },
      {
        "epoch": 28.0,
        "train_loss": 0.46943143010139465,
        "val_rmse": 0.00403866171836853,
        "val_mae": 0.0028577561024576426,
        "val_r2": 0.46883106231689453
      },
      {
        "epoch": 29.0,
        "train_loss": 0.4301523102654351,
        "val_rmse": 0.003959227818995714,
        "val_mae": 0.002791894832625985,
        "val_r2": 0.48952001333236694
      },
      {
        "epoch": 30.0,
        "train_loss": 0.4514329085747401,
        "val_rmse": 0.0037743074353784323,
        "val_mae": 0.002757204929366708,
        "val_r2": 0.5360915660858154
      },
      {
        "epoch": 31.0,
        "train_loss": 0.43957562579049003,
        "val_rmse": 0.004280482418835163,
        "val_mae": 0.003229934023693204,
        "val_r2": 0.4033176302909851
      },
      {
        "epoch": 32.0,
        "train_loss": 0.45439745320214164,
        "val_rmse": 0.003949152305722237,
        "val_mae": 0.0028188314754515886,
        "val_r2": 0.4921149015426636
      },
      {
        "epoch": 33.0,
        "train_loss": 0.4508097486363517,
        "val_rmse": 0.0038752276450395584,
        "val_mae": 0.00286598177626729,
        "val_r2": 0.5109512805938721
      },
      {
        "epoch": 34.0,
        "train_loss": 0.4264430304368337,
        "val_rmse": 0.0040458859875798225,
        "val_mae": 0.0030329423025250435,
        "val_r2": 0.46692901849746704
      },
      {
        "epoch": 35.0,
        "train_loss": 0.46878958245118457,
        "val_rmse": 0.004181800410151482,
        "val_mae": 0.002979281125590205,
        "val_r2": 0.43051236867904663
      },
      {
        "epoch": 36.0,
        "train_loss": 0.43186385598447585,
        "val_rmse": 0.004166582599282265,
        "val_mae": 0.0031474661082029343,
        "val_r2": 0.43464964628219604
      },
      {
        "epoch": 37.0,
        "train_loss": 0.41105032919181717,
        "val_rmse": 0.004099133424460888,
        "val_mae": 0.0029874530155211687,
        "val_r2": 0.4528053402900696
      },
      {
        "epoch": 38.0,
        "train_loss": 0.42208076268434525,
        "val_rmse": 0.0038242340087890625,
        "val_mae": 0.0027478577103465796,
        "val_r2": 0.5237372517585754
      },
      {
        "epoch": 39.0,
        "train_loss": 0.41597151425149703,
        "val_rmse": 0.0038273369427770376,
        "val_mae": 0.0027312578167766333,
        "val_r2": 0.5229640603065491
      },
      {
        "epoch": 40.0,
        "train_loss": 0.4247817587521341,
        "val_rmse": 0.00371950282715261,
        "val_mae": 0.0027955793775618076,
        "val_r2": 0.549466073513031
      },
      {
        "epoch": 41.0,
        "train_loss": 0.40681350810660255,
        "val_rmse": 0.004030786454677582,
        "val_mae": 0.0028195588383823633,
        "val_r2": 0.4709005355834961
      },
      {
        "epoch": 42.0,
        "train_loss": 0.4310258560710483,
        "val_rmse": 0.004466942977160215,
        "val_mae": 0.0031702350825071335,
        "val_r2": 0.3502017855644226
      },
      {
        "epoch": 43.0,
        "train_loss": 0.44397202134132385,
        "val_rmse": 0.003936319146305323,
        "val_mae": 0.002865063725039363,
        "val_r2": 0.49541038274765015
      },
      {
        "epoch": 44.0,
        "train_loss": 0.3935582786798477,
        "val_rmse": 0.004165994934737682,
        "val_mae": 0.0030062717851251364,
        "val_r2": 0.4348090887069702
      },
      {
        "epoch": 45.0,
        "train_loss": 0.4283686876296997,
        "val_rmse": 0.004203737247735262,
        "val_mae": 0.0030416781082749367,
        "val_r2": 0.42452186346054077
      },
      {
        "epoch": 46.0,
        "train_loss": 0.4292127953635322,
        "val_rmse": 0.003920226823538542,
        "val_mae": 0.0027920864522457123,
        "val_r2": 0.4995276927947998
      },
      {
        "epoch": 47.0,
        "train_loss": 0.4300338725248973,
        "val_rmse": 0.004209049977362156,
        "val_mae": 0.0031752935610711575,
        "val_r2": 0.42306631803512573
      },
      {
        "epoch": 48.0,
        "train_loss": 0.4543822291824553,
        "val_rmse": 0.004077019635587931,
        "val_mae": 0.002863400150090456,
        "val_r2": 0.45869338512420654
      },
      {
        "epoch": 49.0,
        "train_loss": 0.3964966866705153,
        "val_rmse": 0.003927282057702541,
        "val_mae": 0.0029293408151715994,
        "val_r2": 0.49772459268569946
      },
      {
        "epoch": 50.0,
        "train_loss": 0.3979269117116928,
        "val_rmse": 0.00385872321203351,
        "val_mae": 0.0027536912821233273,
        "val_r2": 0.5151081085205078
      }
    ],
    "mu": -5.208833694458008,
    "sigma": 0.786635160446167
  }
}