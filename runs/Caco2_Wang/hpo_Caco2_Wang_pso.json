{
  "algo": "pso",
  "dataset": "Caco2_Wang",
  "seed": 42,
  "search": {
    "trials": 10,
    "best_val_rmse": 0.00381197570823133,
    "best_params": {
      "hidden_dim": 384,
      "num_layers": 4,
      "head_dims": [
        256,
        128,
        128
      ],
      "lr": 0.0019396806804067653,
      "weight_decay": 0.001954548507358632,
      "batch_train": 32,
      "batch_eval": 64,
      "val_fraction": 0.1
    }
  },
  "final_training": {
    "epochs": 50,
    "patience": 12,
    "train_time": 115.61448812484741,
    "val_metrics": {
      "rmse": 0.00381197570823133,
      "mae": 0.002813351107761264,
      "r2": 0.5267855525016785
    },
    "test_metrics": {
      "rmse": 0.0025796182453632355,
      "mae": 0.0019252891652286053,
      "r2": 0.5290169715881348
    },
    "history": [
      {
        "epoch": 1.0,
        "train_loss": 1.2874631683031719,
        "val_rmse": 0.005692528560757637,
        "val_mae": 0.0041718436405062675,
        "val_r2": -0.05528104305267334
      },
      {
        "epoch": 2.0,
        "train_loss": 1.1063236130608454,
        "val_rmse": 0.0052933781407773495,
        "val_mae": 0.00408418383449316,
        "val_r2": 0.0875195860862732
      },
      {
        "epoch": 3.0,
        "train_loss": 0.9826000796424018,
        "val_rmse": 0.006173806264996529,
        "val_mae": 0.005194526165723801,
        "val_r2": -0.24126267433166504
      },
      {
        "epoch": 4.0,
        "train_loss": 0.8988760477966733,
        "val_rmse": 0.005245208740234375,
        "val_mae": 0.004194708541035652,
        "val_r2": 0.10405099391937256
      },
      {
        "epoch": 5.0,
        "train_loss": 0.830228739314609,
        "val_rmse": 0.005229469854384661,
        "val_mae": 0.004283708520233631,
        "val_r2": 0.10941976308822632
      },
      {
        "epoch": 6.0,
        "train_loss": 0.7555465979708565,
        "val_rmse": 0.0052399360574781895,
        "val_mae": 0.004027047194540501,
        "val_r2": 0.10585147142410278
      },
      {
        "epoch": 7.0,
        "train_loss": 0.7285566611422433,
        "val_rmse": 0.005237608216702938,
        "val_mae": 0.004230082500725985,
        "val_r2": 0.10664576292037964
      },
      {
        "epoch": 8.0,
        "train_loss": 0.7369731962680817,
        "val_rmse": 0.005995741579681635,
        "val_mae": 0.005177724175155163,
        "val_r2": -0.17069435119628906
      },
      {
        "epoch": 9.0,
        "train_loss": 0.6611814631356133,
        "val_rmse": 0.004935219883918762,
        "val_mae": 0.003970400895923376,
        "val_r2": 0.20682185888290405
      },
      {
        "epoch": 10.0,
        "train_loss": 0.6068118959665298,
        "val_rmse": 0.0058229826390743256,
        "val_mae": 0.00486337672919035,
        "val_r2": -0.10420238971710205
      },
      {
        "epoch": 11.0,
        "train_loss": 0.6680831511815389,
        "val_rmse": 0.0051512643694877625,
        "val_mae": 0.004225551150739193,
        "val_r2": 0.13585734367370605
      },
      {
        "epoch": 12.0,
        "train_loss": 0.663852239648501,
        "val_rmse": 0.005031333304941654,
        "val_mae": 0.004106366075575352,
        "val_r2": 0.17562663555145264
      },
      {
        "epoch": 13.0,
        "train_loss": 0.518337971634335,
        "val_rmse": 0.005295590031892061,
        "val_mae": 0.004456119611859322,
        "val_r2": 0.08675682544708252
      },
      {
        "epoch": 14.0,
        "train_loss": 0.5438889579640495,
        "val_rmse": 0.006340379361063242,
        "val_mae": 0.005596202332526445,
        "val_r2": -0.3091464042663574
      },
      {
        "epoch": 15.0,
        "train_loss": 0.535563051700592,
        "val_rmse": 0.005361021496355534,
        "val_mae": 0.004581367131322622,
        "val_r2": 0.06404966115951538
      },
      {
        "epoch": 16.0,
        "train_loss": 0.5706769012742572,
        "val_rmse": 0.005125165451318026,
        "val_mae": 0.004194521810859442,
        "val_r2": 0.14459162950515747
      },
      {
        "epoch": 17.0,
        "train_loss": 0.5303642981582217,
        "val_rmse": 0.006365228909999132,
        "val_mae": 0.005626264959573746,
        "val_r2": -0.3194282054901123
      },
      {
        "epoch": 18.0,
        "train_loss": 0.5745230433013704,
        "val_rmse": 0.004757937043905258,
        "val_mae": 0.0039779189974069595,
        "val_r2": 0.262783408164978
      },
      {
        "epoch": 19.0,
        "train_loss": 0.5163174188799329,
        "val_rmse": 0.004879322834312916,
        "val_mae": 0.003975491505116224,
        "val_r2": 0.22468745708465576
      },
      {
        "epoch": 20.0,
        "train_loss": 0.5386539681090249,
        "val_rmse": 0.00458246236667037,
        "val_mae": 0.003239948535338044,
        "val_r2": 0.31615835428237915
      },
      {
        "epoch": 21.0,
        "train_loss": 0.571565556857321,
        "val_rmse": 0.005177371669560671,
        "val_mae": 0.004241914954036474,
        "val_r2": 0.12707608938217163
      },
      {
        "epoch": 22.0,
        "train_loss": 0.4747903496026993,
        "val_rmse": 0.005597129464149475,
        "val_mae": 0.0048268199898302555,
        "val_r2": -0.02020728588104248
      },
      {
        "epoch": 23.0,
        "train_loss": 0.5287846608294381,
        "val_rmse": 0.005818754434585571,
        "val_mae": 0.005009520333260298,
        "val_r2": -0.1025993824005127
      },
      {
        "epoch": 24.0,
        "train_loss": 0.5117849773830838,
        "val_rmse": 0.004076104611158371,
        "val_mae": 0.0030255557503551245,
        "val_r2": 0.4589363932609558
      },
      {
        "epoch": 25.0,
        "train_loss": 0.49600045051839614,
        "val_rmse": 0.0046482267789542675,
        "val_mae": 0.0038274081889539957,
        "val_r2": 0.29638946056365967
      },
      {
        "epoch": 26.0,
        "train_loss": 0.5098815345101886,
        "val_rmse": 0.0049736956134438515,
        "val_mae": 0.004021246451884508,
        "val_r2": 0.1944061517715454
      },
      {
        "epoch": 27.0,
        "train_loss": 0.5030892590681711,
        "val_rmse": 0.004328172653913498,
        "val_mae": 0.0032293659169226885,
        "val_r2": 0.38994795083999634
      },
      {
        "epoch": 28.0,
        "train_loss": 0.48594941529962754,
        "val_rmse": 0.004115145653486252,
        "val_mae": 0.0029430727008730173,
        "val_r2": 0.44852215051651
      },
      {
        "epoch": 29.0,
        "train_loss": 0.473368763923645,
        "val_rmse": 0.004989925771951675,
        "val_mae": 0.004205436911433935,
        "val_r2": 0.1891399621963501
      },
      {
        "epoch": 30.0,
        "train_loss": 0.44868968261612785,
        "val_rmse": 0.00552046624943614,
        "val_mae": 0.004685220308601856,
        "val_r2": 0.007548689842224121
      },
      {
        "epoch": 31.0,
        "train_loss": 0.45973774294058484,
        "val_rmse": 0.004684561863541603,
        "val_mae": 0.003282428253442049,
        "val_r2": 0.28534626960754395
      },
      {
        "epoch": 32.0,
        "train_loss": 0.4630056867996852,
        "val_rmse": 0.003973194397985935,
        "val_mae": 0.002958980156108737,
        "val_r2": 0.48591214418411255
      },
      {
        "epoch": 33.0,
        "train_loss": 0.4755908374985059,
        "val_rmse": 0.004423913545906544,
        "val_mae": 0.0033798394724726677,
        "val_r2": 0.36266034841537476
      },
      {
        "epoch": 34.0,
        "train_loss": 0.4856691145234638,
        "val_rmse": 0.003974080551415682,
        "val_mae": 0.0028953582514077425,
        "val_r2": 0.4856828451156616
      },
      {
        "epoch": 35.0,
        "train_loss": 0.4760568572415246,
        "val_rmse": 0.004023960791528225,
        "val_mae": 0.0029580271802842617,
        "val_r2": 0.47269099950790405
      },
      {
        "epoch": 36.0,
        "train_loss": 0.44450435953007805,
        "val_rmse": 0.004204471595585346,
        "val_mae": 0.0029733856208622456,
        "val_r2": 0.4243207573890686
      },
      {
        "epoch": 37.0,
        "train_loss": 0.4541415787405438,
        "val_rmse": 0.004026693291962147,
        "val_mae": 0.002902026055380702,
        "val_r2": 0.47197455167770386
      },
      {
        "epoch": 38.0,
        "train_loss": 0.43177347216341233,
        "val_rmse": 0.003922149073332548,
        "val_mae": 0.0028474032878875732,
        "val_r2": 0.4990367293357849
      },
      {
        "epoch": 39.0,
        "train_loss": 0.4501110331879722,
        "val_rmse": 0.004012302495539188,
        "val_mae": 0.002855652943253517,
        "val_r2": 0.47574204206466675
      },
      {
        "epoch": 40.0,
        "train_loss": 0.433814557062255,
        "val_rmse": 0.004092334304004908,
        "val_mae": 0.0029174997471272945,
        "val_r2": 0.4546191096305847
      },
      {
        "epoch": 41.0,
        "train_loss": 0.43669707742002273,
        "val_rmse": 0.003890787484124303,
        "val_mae": 0.0028181092347949743,
        "val_r2": 0.507016122341156
      },
      {
        "epoch": 42.0,
        "train_loss": 0.43184399439228904,
        "val_rmse": 0.004092139191925526,
        "val_mae": 0.002923310035839677,
        "val_r2": 0.45467114448547363
      },
      {
        "epoch": 43.0,
        "train_loss": 0.4524535536766052,
        "val_rmse": 0.00424211798235774,
        "val_mae": 0.0034206409472972155,
        "val_r2": 0.41396546363830566
      },
      {
        "epoch": 44.0,
        "train_loss": 0.4578467888964547,
        "val_rmse": 0.004048021510243416,
        "val_mae": 0.0028230352327227592,
        "val_r2": 0.466366171836853
      },
      {
        "epoch": 45.0,
        "train_loss": 0.43517523672845626,
        "val_rmse": 0.0038992254994809628,
        "val_mae": 0.0027521622832864523,
        "val_r2": 0.5048754811286926
      },
      {
        "epoch": 46.0,
        "train_loss": 0.4692252029975255,
        "val_rmse": 0.004155843518674374,
        "val_mae": 0.0029111008625477552,
        "val_r2": 0.4375600814819336
      },
      {
        "epoch": 47.0,
        "train_loss": 0.4095521834161546,
        "val_rmse": 0.004178897012025118,
        "val_mae": 0.00296655367128551,
        "val_r2": 0.43130290508270264
      },
      {
        "epoch": 48.0,
        "train_loss": 0.4842131899462806,
        "val_rmse": 0.003944086376577616,
        "val_mae": 0.002953402465209365,
        "val_r2": 0.49341702461242676
      },
      {
        "epoch": 49.0,
        "train_loss": 0.4659049063920975,
        "val_rmse": 0.00381197570823133,
        "val_mae": 0.002813351107761264,
        "val_r2": 0.5267855525016785
      },
      {
        "epoch": 50.0,
        "train_loss": 0.4170275744464662,
        "val_rmse": 0.0039048241451382637,
        "val_mae": 0.0028407308273017406,
        "val_r2": 0.5034526586532593
      }
    ],
    "mu": -5.208833694458008,
    "sigma": 0.786635160446167
  }
}