{
  "algo": "hc",
  "dataset": "Caco2_Wang",
  "seed": 42,
  "search": {
    "trials": 50,
    "best_val_rmse": 0.003733063815161586,
    "best_params": {
      "hidden_dim": 128,
      "num_layers": 7,
      "head_dims": [
        192,
        96,
        96
      ],
      "lr": 0.004647354568247686,
      "weight_decay": 1.08749712924218e-05,
      "batch_train": 32,
      "batch_eval": 64,
      "val_fraction": 0.1
    }
  },
  "final_training": {
    "epochs": 50,
    "patience": 12,
    "train_time": 32.39100122451782,
    "val_metrics": {
      "rmse": 0.003733063815161586,
      "mae": 0.0027746495325118303,
      "r2": 0.5461748838424683
    },
    "test_metrics": {
      "rmse": 0.002995189744979143,
      "mae": 0.002438821131363511,
      "r2": 0.36504483222961426
    },
    "history": [
      {
        "epoch": 1.0,
        "train_loss": 1.3049597806400723,
        "val_rmse": 0.006886384915560484,
        "val_mae": 0.005035156849771738,
        "val_r2": -0.5443307161331177
      },
      {
        "epoch": 2.0,
        "train_loss": 1.0589002735084958,
        "val_rmse": 0.005206145346164703,
        "val_mae": 0.004005943424999714,
        "val_r2": 0.11734640598297119
      },
      {
        "epoch": 3.0,
        "train_loss": 0.9715043836169772,
        "val_rmse": 0.005087736528366804,
        "val_mae": 0.004059277940541506,
        "val_r2": 0.15703999996185303
      },
      {
        "epoch": 4.0,
        "train_loss": 0.8851087358262804,
        "val_rmse": 0.005153291393071413,
        "val_mae": 0.004233173560351133,
        "val_r2": 0.13517731428146362
      },
      {
        "epoch": 5.0,
        "train_loss": 0.8641274041599698,
        "val_rmse": 0.005713339429348707,
        "val_mae": 0.004898145329207182,
        "val_r2": -0.0630110502243042
      },
      {
        "epoch": 6.0,
        "train_loss": 0.8298108594285117,
        "val_rmse": 0.004932519514113665,
        "val_mae": 0.003978202119469643,
        "val_r2": 0.20768970251083374
      },
      {
        "epoch": 7.0,
        "train_loss": 0.7558793011638854,
        "val_rmse": 0.004910418763756752,
        "val_mae": 0.0040908316150307655,
        "val_r2": 0.21477371454238892
      },
      {
        "epoch": 8.0,
        "train_loss": 0.7337600274218453,
        "val_rmse": 0.005275952164083719,
        "val_mae": 0.004174384754151106,
        "val_r2": 0.09351760149002075
      },
      {
        "epoch": 9.0,
        "train_loss": 0.6974068184693655,
        "val_rmse": 0.005809203255921602,
        "val_mae": 0.004841628950089216,
        "val_r2": -0.09898269176483154
      },
      {
        "epoch": 10.0,
        "train_loss": 0.6435946043994691,
        "val_rmse": 0.005561773665249348,
        "val_mae": 0.004751771688461304,
        "val_r2": -0.007359147071838379
      },
      {
        "epoch": 11.0,
        "train_loss": 0.6271898878945245,
        "val_rmse": 0.00484090019017458,
        "val_mae": 0.003987741190940142,
        "val_r2": 0.23684990406036377
      },
      {
        "epoch": 12.0,
        "train_loss": 0.6360919657680724,
        "val_rmse": 0.004849445540457964,
        "val_mae": 0.003969684708863497,
        "val_r2": 0.23415327072143555
      },
      {
        "epoch": 13.0,
        "train_loss": 0.5970164173179202,
        "val_rmse": 0.005517080891877413,
        "val_mae": 0.004646656569093466,
        "val_r2": 0.008765459060668945
      },
      {
        "epoch": 14.0,
        "train_loss": 0.5744450870487425,
        "val_rmse": 0.010124131105840206,
        "val_mae": 0.009401294402778149,
        "val_r2": -2.3378989696502686
      },
      {
        "epoch": 15.0,
        "train_loss": 0.5670263287093904,
        "val_rmse": 0.004713181406259537,
        "val_mae": 0.003747774288058281,
        "val_r2": 0.27658742666244507
      },
      {
        "epoch": 16.0,
        "train_loss": 0.5719054457214143,
        "val_rmse": 0.004918953403830528,
        "val_mae": 0.004047635942697525,
        "val_r2": 0.21204185485839844
      },
      {
        "epoch": 17.0,
        "train_loss": 0.5648718062374327,
        "val_rmse": 0.004009859170764685,
        "val_mae": 0.0029807807877659798,
        "val_r2": 0.47638028860092163
      },
      {
        "epoch": 18.0,
        "train_loss": 0.5039005511336856,
        "val_rmse": 0.0056063043884932995,
        "val_mae": 0.004931212868541479,
        "val_r2": -0.023554682731628418
      },
      {
        "epoch": 19.0,
        "train_loss": 0.5774287747012244,
        "val_rmse": 0.0057410732842981815,
        "val_mae": 0.004911820404231548,
        "val_r2": -0.07335615158081055
      },
      {
        "epoch": 20.0,
        "train_loss": 0.53105119533009,
        "val_rmse": 0.004539416637271643,
        "val_mae": 0.003510315902531147,
        "val_r2": 0.3289455771446228
      },
      {
        "epoch": 21.0,
        "train_loss": 0.5203789505693648,
        "val_rmse": 0.004315108060836792,
        "val_mae": 0.003324537305161357,
        "val_r2": 0.39362531900405884
      },
      {
        "epoch": 22.0,
        "train_loss": 0.5135616776016023,
        "val_rmse": 0.005443473346531391,
        "val_mae": 0.004685342777520418,
        "val_r2": 0.03503870964050293
      },
      {
        "epoch": 23.0,
        "train_loss": 0.5133132934570312,
        "val_rmse": 0.00444027129560709,
        "val_mae": 0.0034935586154460907,
        "val_r2": 0.35793834924697876
      },
      {
        "epoch": 24.0,
        "train_loss": 0.5197450402710173,
        "val_rmse": 0.004682953003793955,
        "val_mae": 0.00345270661637187,
        "val_r2": 0.2858370542526245
      },
      {
        "epoch": 25.0,
        "train_loss": 0.4976578901211421,
        "val_rmse": 0.005677451379597187,
        "val_mae": 0.004886150825768709,
        "val_r2": -0.049698472023010254
      },
      {
        "epoch": 26.0,
        "train_loss": 0.49878206021255916,
        "val_rmse": 0.004312293138355017,
        "val_mae": 0.003443918190896511,
        "val_r2": 0.3944161534309387
      },
      {
        "epoch": 27.0,
        "train_loss": 0.5426504661639532,
        "val_rmse": 0.0037618381902575493,
        "val_mae": 0.002917287638410926,
        "val_r2": 0.5391517281532288
      },
      {
        "epoch": 28.0,
        "train_loss": 0.5043969882859124,
        "val_rmse": 0.003733063815161586,
        "val_mae": 0.0027746495325118303,
        "val_r2": 0.5461748838424683
      },
      {
        "epoch": 29.0,
        "train_loss": 0.48362937404049766,
        "val_rmse": 0.004225140903145075,
        "val_mae": 0.0032580930273979902,
        "val_r2": 0.4186466932296753
      },
      {
        "epoch": 30.0,
        "train_loss": 0.47702641288439435,
        "val_rmse": 0.006105434615164995,
        "val_mae": 0.005371424835175276,
        "val_r2": -0.21392226219177246
      },
      {
        "epoch": 31.0,
        "train_loss": 0.49156955546802944,
        "val_rmse": 0.004135289695113897,
        "val_mae": 0.0030836279038339853,
        "val_r2": 0.44310981035232544
      },
      {
        "epoch": 32.0,
        "train_loss": 0.5051267594099045,
        "val_rmse": 0.004386938642710447,
        "val_mae": 0.0031313716899603605,
        "val_r2": 0.3732694983482361
      },
      {
        "epoch": 33.0,
        "train_loss": 0.48547220561239457,
        "val_rmse": 0.004131545778363943,
        "val_mae": 0.00300189689733088,
        "val_r2": 0.4441177248954773
      },
      {
        "epoch": 34.0,
        "train_loss": 0.4472550716665056,
        "val_rmse": 0.004434836562722921,
        "val_mae": 0.0033196406438946724,
        "val_r2": 0.35950911045074463
      },
      {
        "epoch": 35.0,
        "train_loss": 0.48507292651467854,
        "val_rmse": 0.003988804295659065,
        "val_mae": 0.002815174637362361,
        "val_r2": 0.48186469078063965
      },
      {
        "epoch": 36.0,
        "train_loss": 0.46030253916978836,
        "val_rmse": 0.004240373615175486,
        "val_mae": 0.002852624747902155,
        "val_r2": 0.4144474267959595
      },
      {
        "epoch": 37.0,
        "train_loss": 0.456384496556388,
        "val_rmse": 0.00448397034779191,
        "val_mae": 0.0034223892726004124,
        "val_r2": 0.34523844718933105
      },
      {
        "epoch": 38.0,
        "train_loss": 0.5155742632018195,
        "val_rmse": 0.003992851357907057,
        "val_mae": 0.0027765287086367607,
        "val_r2": 0.48081278800964355
      },
      {
        "epoch": 39.0,
        "train_loss": 0.4346218870745765,
        "val_rmse": 0.004072899930179119,
        "val_mae": 0.003008974948897958,
        "val_r2": 0.4597868323326111
      },
      {
        "epoch": 40.0,
        "train_loss": 0.452820274564955,
        "val_rmse": 0.003992913290858269,
        "val_mae": 0.0028784528840333223,
        "val_r2": 0.4807966947555542
      }
    ],
    "mu": -5.208833694458008,
    "sigma": 0.786635160446167
  }
}