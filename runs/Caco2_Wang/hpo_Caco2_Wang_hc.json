{
  "algo": "hc",
  "dataset": "Caco2_Wang",
  "seed": 42,
  "search": {
    "trials": 10,
    "best_val_rmse": 0.003776377299800515,
    "best_params": {
      "hidden_dim": 384,
      "num_layers": 3,
      "head_dims": [
        256,
        128,
        128
      ],
      "lr": 0.0029753892046368237,
      "weight_decay": 0.0026719911795099645,
      "batch_train": 32,
      "batch_eval": 64,
      "val_fraction": 0.1
    }
  },
  "final_training": {
    "epochs": 50,
    "patience": 12,
    "train_time": 93.02970457077026,
    "val_metrics": {
      "rmse": 0.003776377299800515,
      "mae": 0.0028754048980772495,
      "r2": 0.5355826616287231
    },
    "test_metrics": {
      "rmse": 0.002977819414809346,
      "mae": 0.002307409420609474,
      "r2": 0.37238824367523193
    },
    "history": [
      {
        "epoch": 1.0,
        "train_loss": 1.142463743686676,
        "val_rmse": 0.005273947957903147,
        "val_mae": 0.003976305481046438,
        "val_r2": 0.09420603513717651
      },
      {
        "epoch": 2.0,
        "train_loss": 1.0581808222664728,
        "val_rmse": 0.006446564570069313,
        "val_mae": 0.005553126335144043,
        "val_r2": -0.35336339473724365
      },
      {
        "epoch": 3.0,
        "train_loss": 0.9255193091101117,
        "val_rmse": 0.006580438930541277,
        "val_mae": 0.005621229764074087,
        "val_r2": -0.41015684604644775
      },
      {
        "epoch": 4.0,
        "train_loss": 0.8084283371766409,
        "val_rmse": 0.006255205720663071,
        "val_mae": 0.005247363355010748,
        "val_r2": -0.2742096185684204
      },
      {
        "epoch": 5.0,
        "train_loss": 0.771199549237887,
        "val_rmse": 0.005970293190330267,
        "val_mae": 0.005088214296847582,
        "val_r2": -0.16077768802642822
      },
      {
        "epoch": 6.0,
        "train_loss": 0.7699116700225406,
        "val_rmse": 0.0050469934940338135,
        "val_mae": 0.0041183410212397575,
        "val_r2": 0.17048704624176025
      },
      {
        "epoch": 7.0,
        "train_loss": 0.6802887800667021,
        "val_rmse": 0.005421578884124756,
        "val_mae": 0.004476627334952354,
        "val_r2": 0.042785465717315674
      },
      {
        "epoch": 8.0,
        "train_loss": 0.6594326280885272,
        "val_rmse": 0.004944666754454374,
        "val_mae": 0.00391711900010705,
        "val_r2": 0.20378243923187256
      },
      {
        "epoch": 9.0,
        "train_loss": 0.617079507973459,
        "val_rmse": 0.005075337830930948,
        "val_mae": 0.0040870183147490025,
        "val_r2": 0.16114360094070435
      },
      {
        "epoch": 10.0,
        "train_loss": 0.6302303787734773,
        "val_rmse": 0.005378523375838995,
        "val_mae": 0.004319698549807072,
        "val_r2": 0.057928621768951416
      },
      {
        "epoch": 11.0,
        "train_loss": 0.5743165877130296,
        "val_rmse": 0.00563008664175868,
        "val_mae": 0.00487162871286273,
        "val_r2": -0.03225719928741455
      },
      {
        "epoch": 12.0,
        "train_loss": 0.5911612096760008,
        "val_rmse": 0.005056852009147406,
        "val_mae": 0.004121825564652681,
        "val_r2": 0.16724324226379395
      },
      {
        "epoch": 13.0,
        "train_loss": 0.6379001604186164,
        "val_rmse": 0.004989466164261103,
        "val_mae": 0.004044779576361179,
        "val_r2": 0.189289391040802
      },
      {
        "epoch": 14.0,
        "train_loss": 0.5999989393684599,
        "val_rmse": 0.00447843736037612,
        "val_mae": 0.0035667619667947292,
        "val_r2": 0.34685325622558594
      },
      {
        "epoch": 15.0,
        "train_loss": 0.5275994423362944,
        "val_rmse": 0.006715707015246153,
        "val_mae": 0.005597182549536228,
        "val_r2": -0.4687274694442749
      },
      {
        "epoch": 16.0,
        "train_loss": 0.5427564134200414,
        "val_rmse": 0.004176342394202948,
        "val_mae": 0.0030246565584093332,
        "val_r2": 0.4319978952407837
      },
      {
        "epoch": 17.0,
        "train_loss": 0.5706514086988237,
        "val_rmse": 0.004164575599133968,
        "val_mae": 0.00297709577716887,
        "val_r2": 0.43519413471221924
      },
      {
        "epoch": 18.0,
        "train_loss": 0.5228634576002756,
        "val_rmse": 0.004315522965043783,
        "val_mae": 0.0032521893735975027,
        "val_r2": 0.3935087323188782
      },
      {
        "epoch": 19.0,
        "train_loss": 0.4923116879330741,
        "val_rmse": 0.004023309331387281,
        "val_mae": 0.0030239883344620466,
        "val_r2": 0.47286170721054077
      },
      {
        "epoch": 20.0,
        "train_loss": 0.4970882087945938,
        "val_rmse": 0.00425388477742672,
        "val_mae": 0.003006909042596817,
        "val_r2": 0.41070985794067383
      },
      {
        "epoch": 21.0,
        "train_loss": 0.5289477888080809,
        "val_rmse": 0.004190162289887667,
        "val_mae": 0.002954591065645218,
        "val_r2": 0.4282325506210327
      },
      {
        "epoch": 22.0,
        "train_loss": 0.4821462167633904,
        "val_rmse": 0.003966229967772961,
        "val_mae": 0.002872329903766513,
        "val_r2": 0.4877128005027771
      },
      {
        "epoch": 23.0,
        "train_loss": 0.46527886225117576,
        "val_rmse": 0.004023629240691662,
        "val_mae": 0.003105846466496587,
        "val_r2": 0.4727779030799866
      },
      {
        "epoch": 24.0,
        "train_loss": 0.4857731759548187,
        "val_rmse": 0.004099113866686821,
        "val_mae": 0.00301811913959682,
        "val_r2": 0.4528105854988098
      },
      {
        "epoch": 25.0,
        "train_loss": 0.47481298115518356,
        "val_rmse": 0.004425304941833019,
        "val_mae": 0.003137629246339202,
        "val_r2": 0.3622593283653259
      },
      {
        "epoch": 26.0,
        "train_loss": 0.5013384636905458,
        "val_rmse": 0.005046991631388664,
        "val_mae": 0.00366689614020288,
        "val_r2": 0.17048758268356323
      },
      {
        "epoch": 27.0,
        "train_loss": 0.47757798267735374,
        "val_rmse": 0.003926615230739117,
        "val_mae": 0.002826919313520193,
        "val_r2": 0.49789518117904663
      },
      {
        "epoch": 28.0,
        "train_loss": 0.4845910155110889,
        "val_rmse": 0.0038010342977941036,
        "val_mae": 0.0027993235271424055,
        "val_r2": 0.5294982194900513
      },
      {
        "epoch": 29.0,
        "train_loss": 0.4661334314280086,
        "val_rmse": 0.003793383715674281,
        "val_mae": 0.002837410429492593,
        "val_r2": 0.5313903093338013
      },
      {
        "epoch": 30.0,
        "train_loss": 0.4391732994053099,
        "val_rmse": 0.0039863139390945435,
        "val_mae": 0.002848033793270588,
        "val_r2": 0.4825114607810974
      },
      {
        "epoch": 31.0,
        "train_loss": 0.5169994980096817,
        "val_rmse": 0.004179136361926794,
        "val_mae": 0.0030952843371778727,
        "val_r2": 0.43123769760131836
      },
      {
        "epoch": 32.0,
        "train_loss": 0.5026486251089308,
        "val_rmse": 0.004146783612668514,
        "val_mae": 0.0029956160578876734,
        "val_r2": 0.4400097727775574
      },
      {
        "epoch": 33.0,
        "train_loss": 0.45218472679456073,
        "val_rmse": 0.00434819096699357,
        "val_mae": 0.0034371826332062483,
        "val_r2": 0.3842918276786804
      },
      {
        "epoch": 34.0,
        "train_loss": 0.44163833889696336,
        "val_rmse": 0.004061034414917231,
        "val_mae": 0.0028247793670743704,
        "val_r2": 0.46292978525161743
      },
      {
        "epoch": 35.0,
        "train_loss": 0.4590921534432305,
        "val_rmse": 0.003893729764968157,
        "val_mae": 0.0028365040197968483,
        "val_r2": 0.5062702298164368
      },
      {
        "epoch": 36.0,
        "train_loss": 0.4704176262021065,
        "val_rmse": 0.004007192328572273,
        "val_mae": 0.0028417608700692654,
        "val_r2": 0.4770766496658325
      },
      {
        "epoch": 37.0,
        "train_loss": 0.49501945740646786,
        "val_rmse": 0.003922163508832455,
        "val_mae": 0.002869636984542012,
        "val_r2": 0.49903297424316406
      },
      {
        "epoch": 38.0,
        "train_loss": 0.47554783191945815,
        "val_rmse": 0.004396344535052776,
        "val_mae": 0.003094285726547241,
        "val_r2": 0.3705790638923645
      },
      {
        "epoch": 39.0,
        "train_loss": 0.4893193220098813,
        "val_rmse": 0.004188006278127432,
        "val_mae": 0.0030141801107674837,
        "val_r2": 0.42882078886032104
      },
      {
        "epoch": 40.0,
        "train_loss": 0.4693451937701967,
        "val_rmse": 0.003776377299800515,
        "val_mae": 0.0028754048980772495,
        "val_r2": 0.5355826616287231
      },
      {
        "epoch": 41.0,
        "train_loss": 0.4768640821178754,
        "val_rmse": 0.004100174643099308,
        "val_mae": 0.00291359587572515,
        "val_r2": 0.45252740383148193
      },
      {
        "epoch": 42.0,
        "train_loss": 0.4369575199153688,
        "val_rmse": 0.003954486921429634,
        "val_mae": 0.0030132264364510775,
        "val_r2": 0.4907418489456177
      },
      {
        "epoch": 43.0,
        "train_loss": 0.4491358763641781,
        "val_rmse": 0.0046735238283872604,
        "val_mae": 0.003234757110476494,
        "val_r2": 0.2887100577354431
      },
      {
        "epoch": 44.0,
        "train_loss": 0.42972492343849605,
        "val_rmse": 0.0045350901782512665,
        "val_mae": 0.0032140188850462437,
        "val_r2": 0.33022403717041016
      },
      {
        "epoch": 45.0,
        "train_loss": 0.45122219290998244,
        "val_rmse": 0.00414474168792367,
        "val_mae": 0.002966721076518297,
        "val_r2": 0.44056111574172974
      },
      {
        "epoch": 46.0,
        "train_loss": 0.4541541486978531,
        "val_rmse": 0.004453921690583229,
        "val_mae": 0.003112345701083541,
        "val_r2": 0.353984534740448
      },
      {
        "epoch": 47.0,
        "train_loss": 0.46060960325929856,
        "val_rmse": 0.004191858693957329,
        "val_mae": 0.002950774971395731,
        "val_r2": 0.4277695417404175
      },
      {
        "epoch": 48.0,
        "train_loss": 0.45060988432831234,
        "val_rmse": 0.0038554042112082243,
        "val_mae": 0.0027695700991898775,
        "val_r2": 0.515941858291626
      },
      {
        "epoch": 49.0,
        "train_loss": 0.49210472570525277,
        "val_rmse": 0.004451597109436989,
        "val_mae": 0.0031755450181663036,
        "val_r2": 0.35465872287750244
      },
      {
        "epoch": 50.0,
        "train_loss": 0.46704654892285663,
        "val_rmse": 0.003979427739977837,
        "val_mae": 0.0028922457713633776,
        "val_r2": 0.48429787158966064
      }
    ],
    "mu": -5.208833694458008,
    "sigma": 0.786635160446167
  }
}