{
  "algo": "hc",
  "dataset": "tox21",
  "seed": 42,
  "search": {
    "trials": 50,
    "best_val_rmse": -0.5833333333333334,
    "best_params": {
      "hidden_dim": 64,
      "num_layers": 7,
      "head_dims": [
        256,
        192,
        32
      ],
      "lr": 0.00023494351509657438,
      "weight_decay": 2.3961223332560402e-05,
      "batch_train": 32,
      "batch_eval": 64,
      "val_fraction": 0.1
    }
  },
  "final_training": {
    "epochs": 50,
    "patience": 12,
    "train_time": 157.16000127792358,
    "val_metrics": {
      "auc_roc": 0.6805949966193373,
      "f1": 0.5833333333333334,
      "accuracy": 0.9803149606299213,
      "precision": 0.7777777777777778,
      "recall": 0.4666666666666667
    },
    "test_metrics": {
      "auc_roc": 0.6520046472758403,
      "f1": 0.4329896907216495,
      "accuracy": 0.9621472814865795,
      "precision": 0.8076923076923077,
      "recall": 0.29577464788732394
    },
    "history": [
      {
        "epoch": 1.0,
        "train_loss": 0.4920815125211969,
        "val_auc_roc": 0.5886409736308316,
        "val_f1": 0.2857142857142857,
        "val_accuracy": 0.9507874015748031
      },
      {
        "epoch": 2.0,
        "train_loss": 0.314736419624382,
        "val_auc_roc": 0.6896551724137931,
        "val_f1": 0.375,
        "val_accuracy": 0.9606299212598425
      },
      {
        "epoch": 3.0,
        "train_loss": 0.22927637721275115,
        "val_auc_roc": 0.7265720081135902,
        "val_f1": 0.3448275862068966,
        "val_accuracy": 0.9625984251968503
      },
      {
        "epoch": 4.0,
        "train_loss": 0.1798758545851374,
        "val_auc_roc": 0.7223799864773496,
        "val_f1": 0.375,
        "val_accuracy": 0.9606299212598425
      },
      {
        "epoch": 5.0,
        "train_loss": 0.14895600195114428,
        "val_auc_roc": 0.7235970250169033,
        "val_f1": 0.41379310344827586,
        "val_accuracy": 0.9665354330708661
      },
      {
        "epoch": 6.0,
        "train_loss": 0.13262234776691123,
        "val_auc_roc": 0.7387423935091277,
        "val_f1": 0.0,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 7.0,
        "train_loss": 0.12151952825121946,
        "val_auc_roc": 0.7836375929682217,
        "val_f1": 0.3333333333333333,
        "val_accuracy": 0.968503937007874
      },
      {
        "epoch": 8.0,
        "train_loss": 0.11610848571245487,
        "val_auc_roc": 0.7026369168356998,
        "val_f1": 0.42857142857142855,
        "val_accuracy": 0.968503937007874
      },
      {
        "epoch": 9.0,
        "train_loss": 0.10901525772951699,
        "val_auc_roc": 0.7849898580121704,
        "val_f1": 0.38095238095238093,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 10.0,
        "train_loss": 0.10561691396511518,
        "val_auc_roc": 0.8028397565922921,
        "val_f1": 0.46153846153846156,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 11.0,
        "train_loss": 0.10279808732700514,
        "val_auc_roc": 0.7223799864773495,
        "val_f1": 0.4,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 12.0,
        "train_loss": 0.09837225689129396,
        "val_auc_roc": 0.7737660581473969,
        "val_f1": 0.42105263157894735,
        "val_accuracy": 0.9783464566929134
      },
      {
        "epoch": 13.0,
        "train_loss": 0.09609646416575342,
        "val_auc_roc": 0.7457741717376605,
        "val_f1": 0.42857142857142855,
        "val_accuracy": 0.968503937007874
      },
      {
        "epoch": 14.0,
        "train_loss": 0.09139391934902935,
        "val_auc_roc": 0.7853955375253551,
        "val_f1": 0.38095238095238093,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 15.0,
        "train_loss": 0.09319466611670031,
        "val_auc_roc": 0.7602434077079108,
        "val_f1": 0.36363636363636365,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 16.0,
        "train_loss": 0.08955536896063314,
        "val_auc_roc": 0.7752535496957403,
        "val_f1": 0.46153846153846156,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 17.0,
        "train_loss": 0.08654093561316287,
        "val_auc_roc": 0.7522650439486138,
        "val_f1": 0.42857142857142855,
        "val_accuracy": 0.968503937007874
      },
      {
        "epoch": 18.0,
        "train_loss": 0.08559060565658383,
        "val_auc_roc": 0.7248140635564571,
        "val_f1": 0.4,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 19.0,
        "train_loss": 0.0823779178692119,
        "val_auc_roc": 0.7793103448275862,
        "val_f1": 0.48,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 20.0,
        "train_loss": 0.07772162428998447,
        "val_auc_roc": 0.7567275185936444,
        "val_f1": 0.4444444444444444,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 21.0,
        "train_loss": 0.07444059004733612,
        "val_auc_roc": 0.7693035835023664,
        "val_f1": 0.46153846153846156,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 22.0,
        "train_loss": 0.07442731175806139,
        "val_auc_roc": 0.7456389452332657,
        "val_f1": 0.4444444444444444,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 23.0,
        "train_loss": 0.07556501987644217,
        "val_auc_roc": 0.7322515212981745,
        "val_f1": 0.46153846153846156,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 24.0,
        "train_loss": 0.06957533593465398,
        "val_auc_roc": 0.7175118323191346,
        "val_f1": 0.5454545454545454,
        "val_accuracy": 0.9803149606299213
      },
      {
        "epoch": 25.0,
        "train_loss": 0.06834201837753083,
        "val_auc_roc": 0.7575388776200136,
        "val_f1": 0.46153846153846156,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 26.0,
        "train_loss": 0.06401455698052903,
        "val_auc_roc": 0.7584854631507776,
        "val_f1": 0.41379310344827586,
        "val_accuracy": 0.9665354330708661
      },
      {
        "epoch": 27.0,
        "train_loss": 0.0634784261611375,
        "val_auc_roc": 0.7534820824881676,
        "val_f1": 0.5,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 28.0,
        "train_loss": 0.061764574264521366,
        "val_auc_roc": 0.7318458417849899,
        "val_f1": 0.47619047619047616,
        "val_accuracy": 0.9783464566929134
      },
      {
        "epoch": 29.0,
        "train_loss": 0.05925417225807905,
        "val_auc_roc": 0.7360378634212306,
        "val_f1": 0.43478260869565216,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 30.0,
        "train_loss": 0.054059027635550996,
        "val_auc_roc": 0.748208248816768,
        "val_f1": 0.48,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 31.0,
        "train_loss": 0.05693648807977984,
        "val_auc_roc": 0.7505070993914807,
        "val_f1": 0.56,
        "val_accuracy": 0.9783464566929134
      },
      {
        "epoch": 32.0,
        "train_loss": 0.04839966334142051,
        "val_auc_roc": 0.6981744421906693,
        "val_f1": 0.56,
        "val_accuracy": 0.9783464566929134
      },
      {
        "epoch": 33.0,
        "train_loss": 0.050891611347352705,
        "val_auc_roc": 0.6647734956051385,
        "val_f1": 0.5384615384615384,
        "val_accuracy": 0.9763779527559056
      },
      {
        "epoch": 34.0,
        "train_loss": 0.0484661713008072,
        "val_auc_roc": 0.6732927653820149,
        "val_f1": 0.4827586206896552,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 35.0,
        "train_loss": 0.04683388477529992,
        "val_auc_roc": 0.7035835023664638,
        "val_f1": 0.5,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 36.0,
        "train_loss": 0.04529387362861446,
        "val_auc_roc": 0.7315753887762001,
        "val_f1": 0.4375,
        "val_accuracy": 0.9645669291338582
      },
      {
        "epoch": 37.0,
        "train_loss": 0.04711670305097958,
        "val_auc_roc": 0.6567951318458418,
        "val_f1": 0.46153846153846156,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 38.0,
        "train_loss": 0.04139472927631146,
        "val_auc_roc": 0.6805949966193373,
        "val_f1": 0.5833333333333334,
        "val_accuracy": 0.9803149606299213
      },
      {
        "epoch": 39.0,
        "train_loss": 0.039337872818985084,
        "val_auc_roc": 0.6953346855983771,
        "val_f1": 0.5384615384615384,
        "val_accuracy": 0.9763779527559056
      },
      {
        "epoch": 40.0,
        "train_loss": 0.04032052154457392,
        "val_auc_roc": 0.7400946585530763,
        "val_f1": 0.4444444444444444,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 41.0,
        "train_loss": 0.040323377827872764,
        "val_auc_roc": 0.7145368492224475,
        "val_f1": 0.5185185185185185,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 42.0,
        "train_loss": 0.03961418024785296,
        "val_auc_roc": 0.718999323867478,
        "val_f1": 0.4827586206896552,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 43.0,
        "train_loss": 0.03786870019699258,
        "val_auc_roc": 0.7230561189993238,
        "val_f1": 0.4,
        "val_accuracy": 0.9704724409448819
      },
      {
        "epoch": 44.0,
        "train_loss": 0.037314552973330646,
        "val_auc_roc": 0.7012846517917511,
        "val_f1": 0.48,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 45.0,
        "train_loss": 0.0419704419775651,
        "val_auc_roc": 0.7012846517917511,
        "val_f1": 0.4666666666666667,
        "val_accuracy": 0.968503937007874
      },
      {
        "epoch": 46.0,
        "train_loss": 0.03391655254457797,
        "val_auc_roc": 0.7231913455037187,
        "val_f1": 0.5185185185185185,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 47.0,
        "train_loss": 0.038125587080221075,
        "val_auc_roc": 0.7291413116970926,
        "val_f1": 0.5,
        "val_accuracy": 0.9724409448818898
      },
      {
        "epoch": 48.0,
        "train_loss": 0.03005390623551826,
        "val_auc_roc": 0.6718052738336714,
        "val_f1": 0.48,
        "val_accuracy": 0.9744094488188977
      },
      {
        "epoch": 49.0,
        "train_loss": 0.03240273510499929,
        "val_auc_roc": 0.6377281947261664,
        "val_f1": 0.3870967741935484,
        "val_accuracy": 0.9625984251968503
      },
      {
        "epoch": 50.0,
        "train_loss": 0.029231952547284584,
        "val_auc_roc": 0.6704530087897228,
        "val_f1": 0.5185185185185185,
        "val_accuracy": 0.9744094488188977
      }
    ],
    "mu": 0.0,
    "sigma": 1.0
  }
}